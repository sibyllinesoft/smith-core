# Smith Core agentd baseline configuration
# This file intentionally uses the executor-only format consumed by agentd.
# Override values via environment variables where available.

[executor]
node_name = "exec-01"
work_root = "/tmp/agentd/work"
state_dir = "/tmp/agentd/state"
audit_dir = "/tmp/agentd/audit"
user_uid = 65534
user_gid = 65534
landlock_enabled = true
egress_proxy_socket = "/tmp/smith-egress-proxy.sock"
metrics_port = 19090

[executor.intent_streams."shell.exec.v1"]
subject = "smith.intents.shell.exec.v1"
max_age = "5m"
max_bytes = "536870912B"
workers = 1

[executor.intent_streams."fs.read.v1"]
subject = "smith.intents.fs.read.v1"
max_age = "10m"
max_bytes = "536870912B"
workers = 1

[executor.intent_streams."http.fetch.v1"]
subject = "smith.intents.http.fetch.v1"
max_age = "10m"
max_bytes = "536870912B"
workers = 1

[executor.results]
subject_prefix = "smith.results."
max_age = "30m"

[executor.limits]
overrides = {}

[executor.limits.defaults]
cpu_ms_per_100ms = 50
mem_bytes = 268435456
io_bytes = 10485760
pids_max = 32
tmpfs_mb = 64
intent_max_bytes = 65536

[executor.security]
pubkeys_dir = "agent/agentd/config/trusted_signers"
jwt_issuers = ["https://localhost/"]
strict_sandbox = true
network_isolation = false
allowed_destinations = []

[executor.capabilities]
derivations_path = "agent/agentd/build/capability/sandbox_profiles/derivations.json"
enforcement_enabled = true

[executor.policy]
update_interval_seconds = 300
updates_subject = "smith.policies.updates"

[executor.nats_config]
servers = ["nats://127.0.0.1:4222"]
jetstream_domain = ""

[executor.attestation]
enable_capability_signing = false
enable_image_verification = false
enable_slsa_provenance = false
fail_on_signature_error = false
provenance_output_dir = "agent/agentd/build/attestation"
verification_cache_ttl = 3600
periodic_verification_interval = 300

[executor.vm_pool]
enabled = false
# method defaults:
# - macOS: "gondolin"
# - other OSes: "host"
volume_root = "/tmp/agentd/vm-pool"
shell = "/bin/bash"
shell_args = ["-lc"]
max_vms = 8
idle_shutdown_seconds = 900
prune_after_seconds = 3600

[executor.vm_pool.env]

[executor.vm_pool.gondolin]
command = "gondolin"
args = ["exec", "--"]
